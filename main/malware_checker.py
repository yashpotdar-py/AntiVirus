import hashlib
import os

malware_hash = list(open("main\hash_key.txt", 'r').read().split("\n"))
malware_name = list(open("main\hash_name.txt", 'r').read().split("\n"))


def sha256_file(file_name):
    with open(file_name, 'rb') as f:
        bytes = f.read()
        sha256hash = hashlib.sha256(bytes).hexdigest()
        f.close()

    return sha256hash

# Deep scanning for finding 
def sha256_folder(folder_path):
    
    files = []
    dir_list = list()
    for(dir_path, dir_name, file_name) in os.walk(folder_path):
        dir_list += [os.path.join(dir_path, file) for file in file_name]
    
    for dir in dir_list:
        #print(dir)
        if sha256_file(dir) != 0:
            files.append(sha256_file(dir) + ":: FILE :: " + dir)
    print(*files, sep="\n")

# sha256_folder(r"C:\\Users\\Yogesh P\\Desktop\\AntiVirus\\virus")

# Checking for malware or virus in a single file 
def file_scanner(file_path):
    file_hash = sha256_file(file_path)
    global malware_hash
    counter = 0
    
    # checking each file
    for hash in malware_hash:
        if hash == file_hash:
            # print("MALWARE DETECTED")
            return malware_name[counter]
        counter += 1
    return "No Malware"
#print(check_hash("path/to/file"))


# Checking for malware of virus in folder

def folder_scanner(folder_path):
    
    virus_file_name = []
    #folder_path = ""
    directory_list = list()
    
    # for deep scanning
    for(dir_path, dir_name, file_name) in os.walk(folder_path):
        directory_list += [os.path.join(dir_path, file) for file in file_name]

    # checking each file
    for dir in directory_list:
        #print(dir)
        if file_scanner(dir) != 0:
            virus_file_name.append("|| Virus : " + file_scanner(dir) + " || File : " + dir)
    print(*virus_file_name, sep="\n")

folder_scanner(r"C:\\Users\\Yogesh P\\Desktop\\AntiVirus\\virus")
#folder_scanner(r"/folder/path/") # --> r converts the path from a normal string to a raw string #

def virus_remover(path):
    pass